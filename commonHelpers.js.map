{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\ndocument.addEventListener('DOMContentLoaded', async function(){\n  const apiKey = '42207002-bb01baf83cbb3b924a651843b';\n  const searchInput = document.getElementById('searchInput');\n  const searchButton = document.getElementById('searchButton');\n  const imageContainer = document.getElementById('imageContainer');\n  const loadingIndicator = document.getElementById('loadingIndicator');\n  const loadMoreButton = document.getElementById('loadMoreButton');\n  const searchForm = document.getElementById('searchForm'); \n  const endOfResultsMessage = document.getElementById('endOfResultsMessage'); \n\n  let currentPage = 1;\n  let currentSearchTerm = '';\n  let totalHits = 0; \n  \n  searchForm.addEventListener('submit', async (event) => {\n      event.preventDefault();\n      const searchTerm = searchInput.value.trim();\n    \n      if (searchTerm) {\n          currentSearchTerm = searchTerm; \n          currentPage = 1; \n          showLoadingIndicator();\n          try {\n              await searchImages(currentSearchTerm, currentPage);\n          } catch (error) {\n              console.error('Error occurred during search:', error);\n          } finally {\n              hideLoadingIndicator();\n              handleLoadMoreButtonVisibility(); \n          }\n      } else {\n          iziToast.error({\n              title: 'Error',\n              message: 'Please enter a search term.',\n          });\n      }\n  });\n\n  loadMoreButton.addEventListener('click', async () => {\n      currentPage++; \n      showLoadingIndicator();\n      try {\n          await searchImages(currentSearchTerm, currentPage);\n      } catch (error) {\n          console.error('Error occurred during search:', error);\n      } finally {\n          hideLoadingIndicator();\n          handleLoadMoreButtonVisibility();\n      }\n  });\n\n  function showLoadingIndicator() {\n      loadingIndicator.style.display = 'block';\n  }\n  \n  function hideLoadingIndicator() {\n      if(loadingIndicator && loadingIndicator.style.display !== 'none'){\n          loadingIndicator.style.display = 'none';\n      }\n  }\n\n  async function searchImages(query, page) {\n      const url = `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(query)}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=15`; \n\n      try {\n          const response = await axios.get(url);\n          const data = response.data;\n\n          if (data.hits && data.hits.length > 0) {\n            totalHits = data.totalHits;\n            if (page === 1) {\n                clearImages(); \n            }\n            displayImages(data.hits);\n\n          } else {\n              if (page === 1) { \n                  iziToast.info({\n                      title: 'Info',\n                      message: 'Sorry, there are no images matching your search query. Please try again.',\n                  });\n                  clearImages();\n              } else { \n                  loadMoreButton.style.display = 'none';\n              }\n          }\n      } catch (error) {\n          throw new Error('An error occurred while fetching images. Please try again.');\n      }\n  }\n\n  const lightbox = new SimpleLightbox('.card-link');\n  function displayImages(images) {\n      const html = images.map(image => generateImageCard(image)).join('');\n      imageContainer.innerHTML += html; \n      clearImages(); \n      lightbox.refresh();\n  }\n\n  function generateImageCard(image) {\n      return `\n          <div class=\"image-card\">\n              <a href=\"${image.largeImageURL}\" class=\"card-link\" data-lightbox=\"image\">\n                  <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"card-image\">\n              </a>\n              <div class=\"card-details\">\n                  <p class=\"card-text\"><strong>Likes:</strong> ${image.likes}</p>\n                  <p class=\"card-text\"><strong>Views:</strong> ${image.views}</p>\n              </div>\n              <div class=\"card-details\">\n                  <p class=\"card-text\"><strong>Comments:</strong> ${image.comments}</p>\n                  <p class=\"card-text\"><strong>Downloads:</strong> ${image.downloads}</p>\n              </div>\n          </div>\n      `;\n  }\n\n  function clearImages() {\n    imageContainer.innerHTML = '';\n  }\n\n  function handleLoadMoreButtonVisibility() {\n    if (totalHits > currentPage * 40) { \n        loadMoreButton.style.display = 'block';\n        endOfResultsMessage.style.display = 'none';\n    } else { \n        loadMoreButton.style.display = 'none';\n        endOfResultsMessage.style.display = 'block';\n        endOfResultsMessage.innerText = \"We're sorry, but you've reached the end of search results.\";\n    }\n  }\n});"],"names":["apiKey","searchInput","imageContainer","loadingIndicator","loadMoreButton","searchForm","endOfResultsMessage","currentPage","currentSearchTerm","totalHits","event","searchTerm","showLoadingIndicator","searchImages","error","hideLoadingIndicator","handleLoadMoreButtonVisibility","iziToast","query","page","url","data","axios","clearImages","displayImages","lightbox","SimpleLightbox","images","html","image","generateImageCard"],"mappings":"owBAMA,SAAS,iBAAiB,mBAAoB,gBAAgB,CAC5D,MAAMA,EAAS,qCACTC,EAAc,SAAS,eAAe,aAAa,EACpC,SAAS,eAAe,cAAc,EAC3D,MAAMC,EAAiB,SAAS,eAAe,gBAAgB,EACzDC,EAAmB,SAAS,eAAe,kBAAkB,EAC7DC,EAAiB,SAAS,eAAe,gBAAgB,EACzDC,EAAa,SAAS,eAAe,YAAY,EACjDC,EAAsB,SAAS,eAAe,qBAAqB,EAEzE,IAAIC,EAAc,EACdC,EAAoB,GACpBC,EAAY,EAEhBJ,EAAW,iBAAiB,SAAU,MAAOK,GAAU,CACnDA,EAAM,eAAc,EACpB,MAAMC,EAAaV,EAAY,MAAM,KAAI,EAEzC,GAAIU,EAAY,CACZH,EAAoBG,EACpBJ,EAAc,EACdK,IACA,GAAI,CACA,MAAMC,EAAaL,EAAmBD,CAAW,CACpD,OAAQO,EAAO,CACZ,QAAQ,MAAM,gCAAiCA,CAAK,CAClE,QAAoB,CACNC,IACAC,GACH,CACX,MACUC,EAAS,MAAM,CACX,MAAO,QACP,QAAS,6BACvB,CAAW,CAEX,CAAG,EAEDb,EAAe,iBAAiB,QAAS,SAAY,CACjDG,IACAK,IACA,GAAI,CACA,MAAMC,EAAaL,EAAmBD,CAAW,CACpD,OAAQO,EAAO,CACZ,QAAQ,MAAM,gCAAiCA,CAAK,CAC9D,QAAgB,CACNC,IACAC,GACH,CACP,CAAG,EAED,SAASJ,GAAuB,CAC5BT,EAAiB,MAAM,QAAU,OACpC,CAED,SAASY,GAAuB,CACzBZ,GAAoBA,EAAiB,MAAM,UAAY,SACtDA,EAAiB,MAAM,QAAU,OAExC,CAED,eAAeU,EAAaK,EAAOC,EAAM,CACrC,MAAMC,EAAM,gCAAgCpB,CAAM,MAAM,mBAAmBkB,CAAK,CAAC,iEAAiEC,CAAI,eAEtJ,GAAI,CAEA,MAAME,GADW,MAAMC,EAAM,IAAIF,CAAG,GACd,KAElBC,EAAK,MAAQA,EAAK,KAAK,OAAS,GAClCZ,EAAYY,EAAK,UACbF,IAAS,GACTI,IAEJC,EAAcH,EAAK,IAAI,GAGjBF,IAAS,GACTF,EAAS,KAAK,CACV,MAAO,OACP,QAAS,0EAC/B,CAAmB,EACDM,KAEAnB,EAAe,MAAM,QAAU,MAG1C,MAAe,CACZ,MAAM,IAAI,MAAM,4DAA4D,CAC/E,CACJ,CAED,MAAMqB,EAAW,IAAIC,EAAe,YAAY,EAChD,SAASF,EAAcG,EAAQ,CAC3B,MAAMC,EAAOD,EAAO,IAAIE,GAASC,EAAkBD,CAAK,CAAC,EAAE,KAAK,EAAE,EAClE3B,EAAe,WAAa0B,EAC5BL,IACAE,EAAS,QAAO,CACnB,CAED,SAASK,EAAkBD,EAAO,CAC9B,MAAO;AAAA;AAAA,yBAEYA,EAAM,aAAa;AAAA,8BACdA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA,iEAGHA,EAAM,KAAK;AAAA,iEACXA,EAAM,KAAK;AAAA;AAAA;AAAA,oEAGRA,EAAM,QAAQ;AAAA,qEACbA,EAAM,SAAS;AAAA;AAAA;AAAA,OAIjF,CAED,SAASN,GAAc,CACrBrB,EAAe,UAAY,EAC5B,CAED,SAASc,GAAiC,CACpCP,EAAYF,EAAc,IAC1BH,EAAe,MAAM,QAAU,QAC/BE,EAAoB,MAAM,QAAU,SAEpCF,EAAe,MAAM,QAAU,OAC/BE,EAAoB,MAAM,QAAU,QACpCA,EAAoB,UAAY,6DAErC,CACH,CAAC"}